<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register Page</title>
    <link rel="stylesheet" type="text/css" href="/styles.css">
    <!-- jQuery 추가: jQuery 라이브러리를 먼저 로드 : 아이디 중복 확인, 비밀번호 일치 여부 JS를 위한.. -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
<!-- 상단 헤더 -->
<a href="/">홈으로 돌아가기</a>

<!-- 회원가입 폼 -->
<form action="/register" method="post">
    <h2>회원가입 페이지</h2>

    <div>
        <label for="userID">아이디</label>
        <input type="text" id="userID" name="userID" required>
        <button type="button" class="inline-button" id="checkIdBtn">중복 확인</button>
        <div id="idCheckMessage" style="color:green;"></div>
    </div>

    <div>
        <label for="userPW">비밀번호</label>
        <input type="password" id="userPW" name="userPW" required>
    </div>

    <div>
        <label for="confirmuserPW">비밀번호 확인</label>
        <input type="password" id="confirmuserPW" name="confirmuserPW" required>
        <div id="pwErrorMessage" style="color:red;"></div>
    </div>

    <div>
        <label for="userName">이름</label>
        <input type="text" id="userName" name="userName">
    </div>

    <div>
        <label for="userEmail">이메일</label>
        <input type="text" id="userEmail" name="userEmail">
    </div>

    <div>
        <label for="userPhone">전화번호</label>
        <input type="text" id="userPhone" name="userPhone">
    </div>
    <div>
        <button type="submit">회원가입하기</button>
    </div>
</form>

<!-- JavaScript -->
<script>
    $(document).ready(function() {
        $('#checkIdBtn').on('click', function() {
            const userID = $('#userID').val();
            if (userID) {   //필드에 뭐라도 적은 상태면 아래 로직으로 중복 체크
                $.get('/check-duplicate-id', {userID: userID}, function(response) {
                    if (response) {
                        $('#idCheckMessage').text('사용 가능한 아이디입니다.');
                    } else {
                        $('#idCheckMessage').text('이미 사용 중인 아이디입니다.').css('color','red');
                    }
                });
            } else {    //빈 칸인 상태로 누를 경우 팝업창 띄우기
                alert('아이디를 입력해 주세요.');
            }
        });

        $('#confirmuserPW').on('input', function() {
            const userPW = $('#userPW').val();
            const confirmPW = $(this).val();

            if (userPW !== confirmPW) {
                $('#pwErrorMessage').text('비밀번호가 일치하지 않습니다.');
            } else {
                $('#pwErrorMessage').text('');  //일치하면 메세지 안 띄우게 공백
            }
        });
    });
</script>

</body>
</html>
